<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gravity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-79108a0fc1995748cbd19a5b0e3e3e7c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../website/index.html"> 
<span class="menu-text">Physics 360: Modern Astrophysics</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../lectures/preliminaries.html">
 <span class="dropdown-text">Preliminaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/gravity.html">
 <span class="dropdown-text">Gravity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../tutorials/python_setup.html">
 <span class="dropdown-text">Setup python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/gala_tutorial.html">
 <span class="dropdown-text">gala tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/integrate-1D-poissonEquation.html">
 <span class="dropdown-text">Poisson equation tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/Intro_3D_visualization.html">
 <span class="dropdown-text">3D vis tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/lagrangian-hydrodynamics.html">
 <span class="dropdown-text">Lagrangian Hydro</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials/pyro_tutorial.html">
 <span class="dropdown-text">2D Hydro</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href=".././tutorials/plasma_pic_1d.ipynb">
 <span class="dropdown-text">1D PIC plasma code</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignments" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Assignments</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignments">    
        <li>
    <a class="dropdown-item" href="../assignments/assignment_1.html">
 <span class="dropdown-text">Workflow</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-final-project" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Final Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-final-project">    
        <li>
    <a class="dropdown-item" href="../final_project/project_ideas.html">
 <span class="dropdown-text">Project Suggestions</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KIPAC/360"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning Goals</a></li>
  <li><a href="#collision-less-systems" id="toc-collision-less-systems" class="nav-link" data-scroll-target="#collision-less-systems">Collision-less Systems</a>
  <ul class="collapse">
  <li><a href="#newtonian-gravity-3-ways" id="toc-newtonian-gravity-3-ways" class="nav-link" data-scroll-target="#newtonian-gravity-3-ways">Newtonian Gravity 3 Ways</a>
  <ul class="collapse">
  <li><a href="#forces" id="toc-forces" class="nav-link" data-scroll-target="#forces">Forces</a></li>
  <li><a href="#potentials" id="toc-potentials" class="nav-link" data-scroll-target="#potentials">Potentials</a></li>
  <li><a href="#action-for-n-self-gravitating-bodies" id="toc-action-for-n-self-gravitating-bodies" class="nav-link" data-scroll-target="#action-for-n-self-gravitating-bodies">Action for N Self-Gravitating Bodies</a></li>
  </ul></li>
  <li><a href="#spherical-systems" id="toc-spherical-systems" class="nav-link" data-scroll-target="#spherical-systems">25.3 Spherical Systems</a>
  <ul class="collapse">
  <li><a href="#newtons-theorems" id="toc-newtons-theorems" class="nav-link" data-scroll-target="#newtons-theorems">25.3.1 Newton’s Theorems</a></li>
  <li><a href="#circular-and-escape-speed" id="toc-circular-and-escape-speed" class="nav-link" data-scroll-target="#circular-and-escape-speed">25.3.2 Circular and Escape Speed</a></li>
  <li><a href="#point-mass" id="toc-point-mass" class="nav-link" data-scroll-target="#point-mass">25.3.3 Point Mass</a></li>
  <li><a href="#uniform-density-sphere" id="toc-uniform-density-sphere" class="nav-link" data-scroll-target="#uniform-density-sphere">25.3.3 Uniform Density Sphere</a></li>
  <li><a href="#power-law-density-profile" id="toc-power-law-density-profile" class="nav-link" data-scroll-target="#power-law-density-profile">Power Law Density Profile</a></li>
  <li><a href="#hernquist-and-nfw-models" id="toc-hernquist-and-nfw-models" class="nav-link" data-scroll-target="#hernquist-and-nfw-models">Hernquist and NFW Models</a></li>
  </ul></li>
  <li><a href="#the-virial-theorem" id="toc-the-virial-theorem" class="nav-link" data-scroll-target="#the-virial-theorem">26.3 The Virial Theorem</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="gravity.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Gravity</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-goals" class="level3">
<h3 class="anchored" data-anchor-id="learning-goals">Learning Goals</h3>
<ul>
<li><p>Explore Newtonian Gravity via fores, potentials, and least action principle.</p></li>
<li><p>Cover some commonly used spherical distributions</p></li>
<li><p>Explore stellar dynamics ins more realistic (yet static) potentials using <a href="https://gala-astro.readthedocs.io/en/latest/">gala</a> package.</p></li>
<li><p>Learn key principles of numerical methods used in gravitational dynamics</p></li>
</ul>
</section>
<section id="collision-less-systems" class="level1">
<h1>Collision-less Systems</h1>
<p>Gravity, despite being the weakest of the four fundamental forces, plays a pivotal role on astronomical scales, shaping the structures and dynamics of the universe. Unlike the electromagnetic, strong, and weak forces, which dominate at subatomic and terrestrial scales, gravity’s influence becomes profound over vast distances and when acting on large masses. It governs the formation and evolution of globular clusters, galaxies, and planetary systems, orchestrating the cosmic dance of celestial bodies. Through gravitational attraction, stars coalesce into clusters, galaxies bind their billions of stars together, and planets form stable orbits around their host stars.</p>
<p>In this part of the course, we will delve into collective gravitational phenomena that are essential to understanding astrophysical systems. Key topics include dynamical friction, the process by which massive objects lose momentum and energy due to interactions with a background of less massive particles, shaping the motion of stars and satellites in galaxies. We’ll explore two-body relaxation, which describes how random gravitational encounters between stars in a cluster lead to a redistribution of energy and angular momentum, driving systems toward thermal equilibrium. Lastly, we will study virialization, a crucial concept that describes how self-gravitating systems reach a state of balance between kinetic and potential energy. These phenomena not only underpin the stability and dynamics of astrophysical systems but also provide a framework for understanding their formation, evolution, and ultimate fate.</p>
<p>First let’s recall some basic facts of Newtonian gravity. This chapter is mostly based on Part V of <strong>Kaiser</strong>: <em>Elements of Astrophysics</em>: <a href="../resources/PDFs/elements.pdf">pages 285-300</a>. The other important book on this subject is <span class="citation" data-cites="Binney:2008aa">Binney and Tremaine (<a href="#ref-Binney:2008aa" role="doc-biblioref">2008</a>)</span> which we have <a href="https://www-degruyter-com.stanford.idm.oclc.org/document/doi/10.1515/9781400828722/html">online access</a> to through Stanford Libraries. On the Canvas course site you can find a .pdf version in the files directory.</p>
<section id="newtonian-gravity-3-ways" class="level2">
<h2 class="anchored" data-anchor-id="newtonian-gravity-3-ways">Newtonian Gravity 3 Ways</h2>
<div class="image-container">
<p><img src="../resources/Images/FeynmanMessenger.png" class="float-right img-fluid" style="width:30%;" alt="A Feynman Messenger"> Newtonian gravity can be understood from three complementary perspectives, each providing unique insights into the nature of gravitational interactions. In the following sections, we will explore these perspectives: Forces, where we consider how gravitational acceleration arises directly from pairwise interactions or a continuous mass distribution; Potentials, where we describe the gravitational field as a scalar potential that satisfies Poisson’s equation and links mass to field strength; and Action, where the motion of self-gravitating systems is derived from a variational principle. Together, these approaches offer a comprehensive view of the dynamics governed by Newtonian gravity. If it has been a while you may appreciate (re-)watch <a href="https://www.feynmanlectures.caltech.edu/messenger.html">Feynman’s Messenger lectures</a> on these topics. At the very least they may help to motivate further study.</p>
</div>
<p>For gravity the 4th way please sign up for the General Relativity course physics <a href="https://explorecourses.stanford.edu/search?view=catalog&amp;filter-coursestatus-Active=on&amp;page=0&amp;catalog=&amp;q=PHYSICS+262%3A+General+Relativity">PHYSICS 262: General Relativity</a></p>
<section id="forces" class="level3">
<h3 class="anchored" data-anchor-id="forces">Forces</h3>
<p>In Newton’s theory the acceleration of a particle is the sum over all other particles of <span class="math inline">\(G\)</span> times the mass times the inverse square of the distance.</p>
<p><span class="math display">\[
\ddot{\mathbf{x}}_j=\sum_{i \neq j} \frac{G m_i\left(\mathbf{x}_i-\mathbf{x}_j\right)}{\left|\mathbf{x}_i-\mathbf{x}_j\right|^3}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
G \simeq 6.67 \times 10^{-8} \mathrm{~cm}^3 \mathrm{~g}^{-1} \mathrm{~s}^{-2}
\]</span></p>
<p>For a continuous density distribution this is</p>
<p><span class="math display">\[
\ddot{\mathbf{x}}=\mathbf{g}(\mathbf{x})=G \int d^3 x^{\prime} \rho\left(\mathbf{x}^{\prime}\right) \frac{\left(\mathbf{x}^{\prime}-\mathbf{x}\right)}{\left|\mathbf{x}^{\prime}-\mathbf{x}\right|^3}
\]</span></p>
</section>
<section id="potentials" class="level3">
<h3 class="anchored" data-anchor-id="potentials">Potentials</h3>
<p>The gravitational acceleration <span class="math inline">\(\mathbf{g}\)</span> can be written as the negative of the gradient of the gravitational potential <span class="math inline">\(\mathbf{g}=-\nabla \Phi\)</span> where</p>
<p><span class="math display">\[
\Phi(\mathbf{x})=-G \int d^3 x^{\prime} \frac{\rho\left(\mathbf{x}^{\prime}\right)}{\left|\mathbf{x}^{\prime}-\mathbf{x}\right|}
\]</span></p>
<p>Taking the gradient of <span class="math inline">\(\Phi(\mathbf{x})\)</span> one recovers In addition to the explicit formula for the potential as an spatial integral (25.4) there is also an equivalent local relationship between the Laplacian of the potential <span class="math inline">\(\nabla^2 \Phi\)</span> and the density <span class="math inline">\(\rho\)</span></p>
<p><span id="eq-poisson"><span class="math display">\[
\nabla^2 \Phi=4 \pi G \rho
\tag{1}\]</span></span></p>
<p>which is Poisson’s equation.</p>
<p>If we divide by <span class="math inline">\(4 \pi G\)</span> and integrate both sides of equation (<a href="#eq-poisson" class="quarto-xref">Equation&nbsp;1</a>) over an arbitrary volume <span class="math inline">\(V\)</span>, and then apply the divergence theorem, we obtain</p>
<p><span class="math display">\[
M = \int_{V} \mathrm{~d}^3 \mathbf{x} \rho= \frac{1}{4 \pi G} \int_{V} \mathrm{d}^3 \mathbf{x} \nabla^2 \Phi =
\frac{1}{4 \pi G} \oint_{\partial V} \mathrm{d}^2 \mathbf{S} \cdot \boldsymbol{\nabla} \Phi
\]</span></p>
<p>This is Gauss’s theorem and says that the integral of the normal component of <span class="math inline">\(\nabla \Phi\)</span> over any closed surface, <span class="math inline">\(\partial V\)</span>, divided by <span class="math inline">\(4 \pi G\)</span> equals the mass contained within that surface. This says average accelerations on the surface are only directly related to the mass contained inside it.</p>
</section>
<section id="action-for-n-self-gravitating-bodies" class="level3">
<h3 class="anchored" data-anchor-id="action-for-n-self-gravitating-bodies">Action for N Self-Gravitating Bodies</h3>
<p>The action for <span class="math inline">\(N\)</span> self-gravitating bodies is the starting point for deriving their equations of motion using the variational principle. In classical mechanics, the action is expressed as the time integral of the Lagrangian. For self-gravitating bodies, the Lagrangian has two components: the kinetic energy of the particles and the gravitational potential energy between them.</p>
<section id="general-form-of-the-action" class="level4">
<h4 class="anchored" data-anchor-id="general-form-of-the-action">General Form of the Action</h4>
<p>The action <span class="math inline">\(S\)</span> for <span class="math inline">\(N\)</span> self-gravitating bodies is:</p>
<p><span class="math display">\[
S = \int \mathcal{L} \, \mathrm{d}t,
\]</span></p>
<p>where the Lagrangian <span class="math inline">\(\mathcal{L}\)</span> is given by:</p>
<p><span class="math display">\[
\mathcal{L} = T - U.
\]</span></p>
<p>Here:</p>
<ul>
<li><p><span class="math inline">\(T\)</span> is the total kinetic energy of the system.</p></li>
<li><p><span class="math inline">\(U\)</span> is the total gravitational potential energy of the system.</p></li>
</ul>
<section id="kinetic-energy" class="level5">
<h5 class="anchored" data-anchor-id="kinetic-energy">Kinetic Energy</h5>
<p>The kinetic energy is:</p>
<p><span class="math display">\[
T = \frac{1}{2} \sum_{i=1}^N m_i \|\dot{\mathbf{r}}_i\|^2,
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(m_i\)</span> is the mass of the <span class="math inline">\(i\)</span>-th particle.</p></li>
<li><p><span class="math inline">\(\dot{\mathbf{r}}_i = \frac{\mathrm{d}\mathbf{r}_i}{\mathrm{d}t}\)</span> is the velocity of the <span class="math inline">\(i\)</span>-th particle.</p></li>
</ul>
</section>
<section id="gravitational-potential-energy" class="level5">
<h5 class="anchored" data-anchor-id="gravitational-potential-energy">Gravitational Potential Energy</h5>
<p>The gravitational potential energy is:</p>
<p><span class="math display">\[
U = - \frac{1}{2} \sum_{i=1}^N \sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(G\)</span> is the gravitational constant.</li>
<li></li>
<li><span class="math inline">\(\|\mathbf{r}_i - \mathbf{r}_j\|\)</span> is the Euclidean distance between the <span class="math inline">\(i\)</span>-th and <span class="math inline">\(j\)</span>-th particles.</li>
</ul>
<p>The factor <span class="math inline">\(\frac{1}{2}\)</span> accounts for double-counting each pair of interactions.</p>
</section>
</section>
<section id="full-expression-for-the-action" class="level4">
<h4 class="anchored" data-anchor-id="full-expression-for-the-action">Full Expression for the Action</h4>
<p>Substituting the kinetic and potential energy terms, the action becomes:</p>
<p><span class="math display">\[
S = \int \left( \frac{1}{2} \sum_{i=1}^N m_i \|\dot{\mathbf{r}}_i\|^2 + \frac{1}{2} \sum_{i=1}^N \sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|} \right) \mathrm{d}t.
\]</span></p>
<p>This action governs the dynamics of <span class="math inline">\(N\)</span> self-gravitating bodies under Newtonian gravity.</p>
</section>
<section id="deriving-equations-of-motion" class="level4">
<h4 class="anchored" data-anchor-id="deriving-equations-of-motion">Deriving Equations of Motion</h4>
<p>To find the equations of motion, apply the principle of stationary action:</p>
<p><span class="math display">\[
\delta S = 0.
\]</span></p>
<p>Varying <span class="math inline">\(S\)</span> with respect to <span class="math inline">\(\mathbf{r}_i\)</span> leads to the Euler-Lagrange equations:</p>
<p><span class="math display">\[
m_i \ddot{\mathbf{r}}_i = -\sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|^3} (\mathbf{r}_i - \mathbf{r}_j).
\]</span></p>
<p>This is Newton’s second law for the <span class="math inline">\(i\)</span>-th particle in the gravitational field created by the other particles.</p>
</section>
</section>
</section>
<section id="spherical-systems" class="level2">
<h2 class="anchored" data-anchor-id="spherical-systems">25.3 Spherical Systems</h2>
<section id="newtons-theorems" class="level3">
<h3 class="anchored" data-anchor-id="newtons-theorems">25.3.1 Newton’s Theorems</h3>
<p>Newton found that</p>
<ul>
<li><p><span class="math inline">\(\mathbf{g}=0\)</span> inside a spherical shell of mass.</p></li>
<li><p>The gravity outside such a shell is the same as for an equivalent mass at the origin.</p></li>
</ul>
<p>These can be proved geometrically (see <span class="citation" data-cites="Binney:2008aa">Binney and Tremaine (<a href="#ref-Binney:2008aa" role="doc-biblioref">2008</a>)</span>), and they also follow directly from Gauss’ law and spherical symmetry.</p>
<p>These theorems imply that the gravity <span class="math inline">\(\mathbf{g}(\mathbf{r})\)</span> for an arbitrary spherical system with cumulative mass profile <span class="math inline">\(M(r)\)</span> is</p>
<p><span class="math display">\[
\mathbf{g}=-\frac{G M(r)}{r^2} \hat{\mathbf{r}}
\]</span></p>
</section>
<section id="circular-and-escape-speed" class="level3">
<h3 class="anchored" data-anchor-id="circular-and-escape-speed">25.3.2 Circular and Escape Speed</h3>
<p>The speed of a particle on a circular orbit satisfies</p>
<p><span class="math display">\[
\frac{d v}{d t}=\frac{v^2}{r}=\frac{G M(r)}{r^2} \quad \rightarrow \quad v_{\mathrm{circ}}=\sqrt{G M(r) / r}
\]</span></p>
<p>The escape speed is</p>
<p><span class="math display">\[
v_{\mathrm{esc}}=\sqrt{2 \Phi(r)}
\]</span></p>
<p>where <span class="math inline">\(\Phi\)</span> is measured relative to its value at spatial infinity.</p>
</section>
<section id="point-mass" class="level3">
<h3 class="anchored" data-anchor-id="point-mass">25.3.3 Point Mass</h3>
<p>For a point mass <span class="math inline">\(M(r)=m\)</span>:</p>
<ul>
<li><p>The potential is <span class="math inline">\(\Phi=-G m / r\)</span>.</p></li>
<li><p>The circular velocity is <span class="math inline">\(v_{\text {circ }}=\sqrt{G m / r}\)</span>.</p></li>
<li><p>The escape velocity is <span class="math inline">\(v_{\text {esc }}=\sqrt{2} v_{\text {circ }}\)</span>.</p></li>
<li><p>The <span class="math inline">\(v_{\text {circ }} \propto r^{-1 / 2}\)</span> circular speed profile is usually referred to as a Keplerian profile.</p></li>
</ul>
</section>
<section id="uniform-density-sphere" class="level3">
<h3 class="anchored" data-anchor-id="uniform-density-sphere">25.3.3 Uniform Density Sphere</h3>
<p>For a static uniform sphere of density <span class="math inline">\(\rho\)</span> - The gravity is</p>
<p><span class="math display">\[
g=\frac{G M(r)}{r^2}=\frac{4 \pi}{3} G \rho r .
\]</span></p>
<ul>
<li>The circular speed is</li>
</ul>
<p><span class="math display">\[
v_{\mathrm{circ}}=\sqrt{\frac{4 \pi G \rho}{3}} r
\]</span></p>
<ul>
<li>The orbital period is</li>
</ul>
<p><span class="math display">\[
t_{\text {orbit }}=\frac{2 \pi r}{v_{\text {circ }}}=\sqrt{\frac{3 \pi}{G \rho}}
\]</span></p>
<p>which is independent of the radius of the orbit. - The potential, measured with respect to the origin, is a parabola and the equation of motion for test particles within the sphere is</p>
<p><span class="math display">\[
\ddot{\mathbf{r}}=-\frac{4 \pi G \rho}{3} \mathbf{r}
\]</span></p>
<p>The period of any orbit in this potential is the same as that for a circular orbit.</p>
<ul>
<li>The dynamical time scales corresponding to density <span class="math inline">\(\rho\)</span> have various definitions and you will find orbital time, the collapse time, the <a href="https://en.wikipedia.org/wiki/Free-fall_time">free fall time</a> etc.. These are always on the order of <span class="math inline">\(t_{\mathrm{dyn}}=1 / \sqrt{G \rho}\)</span>.</li>
</ul>
<p>This is the gravitational spherical harmonic oscillator. No phase mixing occurs in such a potential. Nearby particles stay nearby.</p>
</section>
<section id="power-law-density-profile" class="level3">
<h3 class="anchored" data-anchor-id="power-law-density-profile">Power Law Density Profile</h3>
<p>A power law density profile <span class="math inline">\(\rho(r)=\rho_0\left(r / r_0\right)^{-\alpha}\)</span> has - Mass <span class="math inline">\(M(r) \propto r^{3-\alpha}\)</span>. - We need <span class="math inline">\(\alpha&lt;3\)</span> if the mass at the origin is to be finite. - The density cusp at the origin can be ‘softened’ as in the NFW models. - A flat rotation curve results for <span class="math inline">\(\alpha=2\)</span> and is referred to as a singular isothermal sphere profile.</p>
</section>
<section id="hernquist-and-nfw-models" class="level3">
<h3 class="anchored" data-anchor-id="hernquist-and-nfw-models">Hernquist and NFW Models</h3>
<p>Mass condensations that grow in cosmological simulations have been found to be quite well described by double power-law models.</p>
<p>The <span class="citation" data-cites="Navarro:1996aa">Navarro, Frenk, and White (<a href="#ref-Navarro:1996aa" role="doc-biblioref">1996</a>)</span> (NFW) model is</p>
<p><span class="math display">\[
\rho(r) \propto \frac{1}{r\left(r^2+r_c^2\right)}
\]</span></p>
<p>which has asymptotic forms</p>
<p><span class="math display">\[
\rho \propto\left\{\begin{array}{l}
r^{-1} \\
r^{-3}
\end{array}\right\} \quad \text { for } \quad\left\{\begin{array}{l}
r \ll r_c \\
r \gg r_c
\end{array}\right.
\]</span></p>
</section>
</section>
<section id="the-virial-theorem" class="level2">
<h2 class="anchored" data-anchor-id="the-virial-theorem">26.3 The Virial Theorem</h2>
<p>Consider the moment of inertia of a system of point masses <span class="math inline">\(I \equiv \sum m r^2\)</span>. The time derivative is <span class="math inline">\(\dot{I}=2 \sum m \mathbf{r} \cdot \dot{\mathbf{r}}\)</span> and taking a further time derivative gives</p>
<p><span class="math display">\[
\frac{1}{2} \ddot{I}=\sum m \dot{r}^2+\sum m \mathbf{r} \cdot \ddot{\mathbf{r}}
\]</span></p>
<p>Requiring that <span class="math inline">\(\ddot{I}\)</span> vanish for a stable system and expressing the acceleration <span class="math inline">\(\ddot{\mathbf{r}}\)</span> as a sum of the gravity from all the other particles gives</p>
<p><span class="math display">\[
2 T+\sum_{\mathbf{r}} m \mathbf{r} \cdot \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m^{\prime} \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}=0
\]</span></p>
<p>with <span class="math inline">\(T\)</span> the kinetic energy of the particles. Now switching <span class="math inline">\(\mathbf{r} \leftrightarrow \mathbf{r}^{\prime}\)</span> in the last term simply changes the sign, so we can write this as</p>
<p><span class="math display">\[
\begin{gathered}
\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3} \\
=\frac{1}{2}\left[\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}-\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r}^{\prime} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}\right] \\
=-\frac{1}{2} \sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} \frac{G m m^{\prime}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|}=W
\end{gathered}
\]</span></p>
<p>and we therefore have the virial theorem</p>
<p><span class="math display">\[
2 T+W=0
\]</span></p>
<p>The virial theorem provides a useful way to estimate the mass of bound systems. For example, if we assume equal mass particles, then the particle mass <span class="math inline">\(m\)</span> is given by</p>
<p><span class="math display">\[
m=\frac{2}{G} \frac{\sum \dot{r}^2}{\sum_{\text {pairs }} 1 / r_{12}}
\]</span></p>
<p>For a roughly spherical system it is reasonable to assume that the 3-dimensional velocity dispersion in the numerator is 3 times the observed line of sight velocity dispersion. Similarly, the mean harmonic radius which appears in the denominator can be estimated from the observed distribution of projected separations, and this provides a useful way to determine the mass of a gravitating system.</p>
<p>The virial theorem gives the correct answer if the luminous particles trace the mass, but will fail if, for example, the dark matter has a different profile from the luminous particles.</p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Binney:2008aa" class="csl-entry" role="listitem">
Binney, James, and Scott Tremaine. 2008. <em>Second Edition</em>. Princeton: Princeton University Press. <a href="https://doi.org/doi:10.1515/9781400828722">https://doi.org/doi:10.1515/9781400828722</a>.
</div>
<div id="ref-Navarro:1996aa" class="csl-entry" role="listitem">
Navarro, J. F., C. S. Frenk, and S. D. M. White. 1996. <span>“<span class="nocase">The Structure of Cold Dark Matter Halos</span>”</span> 462 (May): 563. <a href="https://doi.org/10.1086/177173">https://doi.org/10.1086/177173</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/KIPAC\.github\.io\/360\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Gravity"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    number-sections: true</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    css: ../styles.css</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#    number-sections: true</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code: true</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Goals</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explore Newtonian Gravity via fores, potentials, and least action principle. </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cover some commonly used spherical distributions </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explore stellar dynamics ins  more realistic (yet static) potentials using <span class="co">[</span><span class="ot">gala</span><span class="co">](https://gala-astro.readthedocs.io/en/latest/)</span> package. </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Learn key principles of numerical methods used in gravitational dynamics</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Collision-less Systems</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>Gravity, despite being the weakest of the four fundamental forces, plays a pivotal role on astronomical scales, shaping the structures and dynamics of the universe. Unlike the electromagnetic, strong, and weak forces, which dominate at subatomic and terrestrial scales, gravity’s influence becomes profound over vast distances and when acting on large masses. It governs the formation and evolution of globular clusters, galaxies, and planetary systems, orchestrating the cosmic dance of celestial bodies. Through gravitational attraction, stars coalesce into clusters, galaxies bind their billions of stars together, and planets form stable orbits around their host stars.</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>In this part of the course, we will delve into collective gravitational phenomena that are essential to understanding astrophysical systems. Key topics include dynamical friction, the process by which massive objects lose momentum and energy due to interactions with a background of less massive particles, shaping the motion of stars and satellites in galaxies. We’ll explore two-body relaxation, which describes how random gravitational encounters between stars in a cluster lead to a redistribution of energy and angular momentum, driving systems toward thermal equilibrium. Lastly, we will study virialization, a crucial concept that describes how self-gravitating systems reach a state of balance between kinetic and potential energy. These phenomena not only underpin the stability and dynamics of astrophysical systems but also provide a framework for understanding their formation, evolution, and ultimate fate.</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>First let's recall some basic facts of Newtonian gravity. This chapter is mostly based on Part V of **Kaiser**: *Elements of Astrophysics*: <span class="co">[</span><span class="ot">pages 285-300</span><span class="co">](../resources/PDFs/elements.pdf)</span>. The other important book on this subject is @Binney:2008aa which we have <span class="co">[</span><span class="ot">online access</span><span class="co">](https://www-degruyter-com.stanford.idm.oclc.org/document/doi/10.1515/9781400828722/html)</span> to through Stanford Libraries. On the Canvas course site you can find a .pdf version in the files directory. </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Newtonian Gravity 3 Ways</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>:::{.image-container}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="al">![A Feynman Messenger](../resources/Images/FeynmanMessenger.png)</span>{.float-right style="width:30%;"}</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>Newtonian gravity can be understood from three complementary perspectives, each providing unique insights into the nature of gravitational interactions. In the following sections, we will explore these perspectives: Forces, where we consider how gravitational acceleration arises directly from pairwise interactions or a continuous mass distribution; Potentials, where we describe the gravitational field as a scalar potential that satisfies Poisson’s equation and links mass to field strength; and Action, where the motion of self-gravitating systems is derived from a variational principle. Together, these approaches offer a comprehensive view of the dynamics governed by Newtonian gravity. If it has been a while you may appreciate (re-)watch <span class="co">[</span><span class="ot">Feynman's Messenger lectures</span><span class="co">](https://www.feynmanlectures.caltech.edu/messenger.html)</span> on these topics. At the very least they may help to motivate further study. </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>For gravity the 4th way please sign up for the General Relativity course physics <span class="co">[</span><span class="ot">PHYSICS 262: General Relativity</span><span class="co">](https://explorecourses.stanford.edu/search?view=catalog&amp;filter-coursestatus-Active=on&amp;page=0&amp;catalog=&amp;q=PHYSICS+262%3A+General+Relativity)</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forces</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>In Newton's theory the acceleration of a particle is the sum over all other particles of $G$ times the mass times the inverse square of the distance.</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>\ddot{\mathbf{x}}_j=\sum_{i \neq j} \frac{G m_i\left(\mathbf{x}_i-\mathbf{x}_j\right)}{\left|\mathbf{x}_i-\mathbf{x}_j\right|^3}</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>where</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>G \simeq 6.67 \times 10^{-8} \mathrm{~cm}^3 \mathrm{~g}^{-1} \mathrm{~s}^{-2}</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>For a continuous density distribution this is</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>\ddot{\mathbf{x}}=\mathbf{g}(\mathbf{x})=G \int d^3 x^{\prime} \rho\left(\mathbf{x}^{\prime}\right) \frac{\left(\mathbf{x}^{\prime}-\mathbf{x}\right)}{\left|\mathbf{x}^{\prime}-\mathbf{x}\right|^3}</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Potentials</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>The gravitational acceleration $\mathbf{g}$ can be written as the negative of the gradient of the gravitational potential $\mathbf{g}=-\nabla \Phi$ where</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>\Phi(\mathbf{x})=-G \int d^3 x^{\prime} \frac{\rho\left(\mathbf{x}^{\prime}\right)}{\left|\mathbf{x}^{\prime}-\mathbf{x}\right|}</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>Taking the gradient of $\Phi(\mathbf{x})$ one recovers </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>In addition to the explicit formula for the potential as an spatial integral (25.4) there is also an equivalent local relationship between the Laplacian of the potential $\nabla^2 \Phi$ and the density $\rho$</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>\nabla^2 \Phi=4 \pi G \rho</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>$$ {#eq-poisson}</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>which is Poisson's equation.</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>If we divide by $4 \pi G$ and integrate both sides of equation (@eq-poisson) over an arbitrary volume $V$, and then apply the divergence theorem, we obtain</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>M = \int_{V} \mathrm{~d}^3 \mathbf{x} \rho= \frac{1}{4 \pi G} \int_{V} \mathrm{d}^3 \mathbf{x} \nabla^2 \Phi = </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>\frac{1}{4 \pi G} \oint_{\partial V} \mathrm{d}^2 \mathbf{S} \cdot \boldsymbol{\nabla} \Phi</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>This  is Gauss's theorem and says that the integral of the normal component of $\nabla \Phi$ over any closed surface, $\partial V$, divided by $4 \pi G$ equals the mass contained within that surface. This says average accelerations on the surface are only directly related to the mass contained inside it.</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### Action for N Self-Gravitating Bodies</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>The action for $N$ self-gravitating bodies is the starting point for deriving their equations of motion </span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>using the variational principle. In classical mechanics, the action is expressed as the time integral of the </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>Lagrangian. For self-gravitating bodies, the Lagrangian has two components: </span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>the kinetic energy of the particles and the gravitational potential energy between them.</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="fu">#### General Form of the Action</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>The action $S$ for $N$ self-gravitating bodies is:</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>S = \int \mathcal{L} \, \mathrm{d}t,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>where the Lagrangian $\mathcal{L}$ is given by:</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>\mathcal{L} = T - U.</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>Here:</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$T$ is the total kinetic energy of the system.</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$U$ is the total gravitational potential energy of the system.</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Kinetic Energy</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>The kinetic energy is:</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>T = \frac{1}{2} \sum_{i=1}^N m_i \|\dot{\mathbf{r}}_i\|^2,</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$m_i$ is the mass of the $i$-th particle.</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\dot{\mathbf{r}}_i = \frac{\mathrm{d}\mathbf{r}_i}{\mathrm{d}t}$ is the velocity of the $i$-th particle.</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gravitational Potential Energy</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>The gravitational potential energy is:</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>U = - \frac{1}{2} \sum_{i=1}^N \sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|},</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$G$ is the gravitational constant.</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\|\mathbf{r}_i - \mathbf{r}_j\|$ is the Euclidean distance between the $i$-th and $j$-th particles.</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>The factor $\frac{1}{2}$ accounts for double-counting each pair of interactions.</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Full Expression for the Action</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>Substituting the kinetic and potential energy terms, the action becomes:</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>S = \int \left( \frac{1}{2} \sum_{i=1}^N m_i \|\dot{\mathbf{r}}_i\|^2 + \frac{1}{2} \sum_{i=1}^N \sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|} \right) \mathrm{d}t.</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>This action governs the dynamics of $N$ self-gravitating bodies under Newtonian gravity.</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Deriving Equations of Motion</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>To find the equations of motion, apply the principle of stationary action:</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>\delta S = 0.</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>Varying $S$ with respect to $\mathbf{r}_i$ leads to the Euler-Lagrange equations:</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>m_i \ddot{\mathbf{r}}_i = -\sum_{j \neq i}^N \frac{G m_i m_j}{\|\mathbf{r}_i - \mathbf{r}_j\|^3} (\mathbf{r}_i - \mathbf{r}_j).</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>This is Newton's second law for the $i$-th particle in the gravitational field created by the other particles.</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## 25.3 Spherical Systems</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### 25.3.1 Newton's Theorems</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>Newton found that</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{g}=0$ inside a spherical shell of mass.</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The gravity outside such a shell is the same as for an equivalent mass at the origin.</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>These can be proved geometrically (see @Binney:2008aa), and they also follow directly from Gauss' law and spherical symmetry.</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>These theorems imply that the gravity $\mathbf{g}(\mathbf{r})$ for an arbitrary spherical system with cumulative mass profile $M(r)$ is</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>\mathbf{g}=-\frac{G M(r)}{r^2} \hat{\mathbf{r}}</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### 25.3.2 Circular and Escape Speed</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>The speed of a particle on a circular orbit satisfies</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>\frac{d v}{d t}=\frac{v^2}{r}=\frac{G M(r)}{r^2} \quad \rightarrow \quad v_{\mathrm{circ}}=\sqrt{G M(r) / r}</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>The escape speed is</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>v_{\mathrm{esc}}=\sqrt{2 \Phi(r)}</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>where $\Phi$ is measured relative to its value at spatial infinity.</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a><span class="fu">### 25.3.3 Point Mass</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>For a point mass $M(r)=m$:</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The potential is $\Phi=-G m / r$.</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The circular velocity is $v_{\text {circ }}=\sqrt{G m / r}$.</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The escape velocity is $v_{\text {esc }}=\sqrt{2} v_{\text {circ }}$.</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The $v_{\text {circ }} \propto r^{-1 / 2}$ circular speed profile is usually referred to as a Keplerian profile.</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="fu">### 25.3.3 Uniform Density Sphere</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>For a static uniform sphere of density $\rho$</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The gravity is</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>g=\frac{G M(r)}{r^2}=\frac{4 \pi}{3} G \rho r .</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The circular speed is</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>v_{\mathrm{circ}}=\sqrt{\frac{4 \pi G \rho}{3}} r</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The orbital period is</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>t_{\text {orbit }}=\frac{2 \pi r}{v_{\text {circ }}}=\sqrt{\frac{3 \pi}{G \rho}}</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>which is independent of the radius of the orbit.</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The potential, measured with respect to the origin, is a parabola and the equation of motion for test particles within the sphere is</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>\ddot{\mathbf{r}}=-\frac{4 \pi G \rho}{3} \mathbf{r}</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>The period of any orbit in this potential is the same as that for a circular orbit.</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The dynamical time scales corresponding to density $\rho$ have various definitions and you will find orbital time, the collapse time, the <span class="co">[</span><span class="ot">free fall time</span><span class="co">](https://en.wikipedia.org/wiki/Free-fall_time)</span> etc.. These are always on the order of $t_{\mathrm{dyn}}=1 / \sqrt{G \rho}$. </span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>This is the gravitational spherical harmonic oscillator. No phase mixing occurs in such a potential. Nearby particles stay nearby. </span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Power Law Density Profile</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>A power law density profile $\rho(r)=\rho_0\left(r / r_0\right)^{-\alpha}$ has</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mass $M(r) \propto r^{3-\alpha}$.</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We need $\alpha&lt;3$ if the mass at the origin is to be finite.</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The density cusp at the origin can be 'softened' as in the NFW models.</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A flat rotation curve results for $\alpha=2$ and is referred to as a singular isothermal sphere profile.</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hernquist and NFW Models</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>Mass condensations that grow in cosmological simulations have been found to be quite well described by double power-law models.</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>The @Navarro:1996aa (NFW) model is</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>\rho(r) \propto \frac{1}{r\left(r^2+r_c^2\right)}</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>which has asymptotic forms</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>\rho \propto\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>r^{-1} <span class="sc">\\</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>r^{-3}</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>\end{array}\right<span class="sc">\}</span> \quad \text { for } \quad\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>r \ll r_c <span class="sc">\\</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>r \gg r_c</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## 26.3 The Virial Theorem</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>Consider the moment of inertia of a system of point masses $I \equiv \sum m r^2$. The time derivative is $\dot{I}=2 \sum m \mathbf{r} \cdot \dot{\mathbf{r}}$ and taking a further time derivative gives</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>\frac{1}{2} \ddot{I}=\sum m \dot{r}^2+\sum m \mathbf{r} \cdot \ddot{\mathbf{r}}</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>Requiring that $\ddot{I}$ vanish for a stable system and expressing the acceleration $\ddot{\mathbf{r}}$ as a sum of the gravity from all the other particles gives</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>2 T+\sum_{\mathbf{r}} m \mathbf{r} \cdot \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m^{\prime} \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}=0</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>with $T$ the kinetic energy of the particles.</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>Now switching $\mathbf{r} \leftrightarrow \mathbf{r}^{\prime}$ in the last term simply changes the sign, so we can write this as</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>\begin{gathered}</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3} <span class="sc">\\</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>=\frac{1}{2}\left<span class="co">[</span><span class="ot">\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}-\sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} G m m^{\prime} \mathbf{r}^{\prime} \cdot \frac{\mathbf{r}^{\prime}-\mathbf{r}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|^3}\right</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>=-\frac{1}{2} \sum_{\mathbf{r}} \sum_{\mathbf{r}^{\prime} \neq \mathbf{r}} \frac{G m m^{\prime}}{\left|\mathbf{r}^{\prime}-\mathbf{r}\right|}=W</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>\end{gathered}</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>and we therefore have the virial theorem</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>2 T+W=0</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>The virial theorem provides a useful way to estimate the mass of bound systems. For example, if we assume equal mass particles, then the particle mass $m$ is given by</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>m=\frac{2}{G} \frac{\sum \dot{r}^2}{\sum_{\text {pairs }} 1 / r_{12}}</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>For a roughly spherical system it is reasonable to assume that the 3-dimensional velocity dispersion in the numerator is 3 times the observed line of sight velocity dispersion. Similarly, the mean harmonic radius which appears in the denominator can be estimated from the observed distribution of projected separations, and this provides a useful way to determine the mass of a gravitating system.</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>The virial theorem gives the correct answer if the luminous particles trace the mass, but will fail if, for example, the dark matter has a different profile from the luminous particles.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>